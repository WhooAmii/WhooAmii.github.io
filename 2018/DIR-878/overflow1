
``` 
Dlink model DIR-878, the latest firmware 1.12B01, There is a stack overflow vulnerability that does not require authentication
This can cause remote code execution
download link: ftp://ftp2.dlink.com/PRODUCTS/DIR-878/REVA/
Vulnerability location: file:  /bin/prog.cgi
Vulnerability function：Different locations in different firmware versions
1.02B01:sub_41F534 
path:webssecurityhandler->sub_423fe4->sub_4205c0->sub_41f720-> sub_41F534(Vulnerability function)
1.12B01: sub_41F254
Path: webssecurityhandler->sub_423e04->sub_4202e0->sub_41f440-> sub_41F254 (Vulnerability function)
The attacker calls this function by sending a post packet to the http://ip/HNAP1/  page
.
Message header HNAP_AUTH length is not verified。At the same time, it uses the strncpy function to write to the stack, But the length of the copy is the length of the string entered by the user.Caused a stack overflow。

``` 
post package

![image](https://github.com/WhooAmii/whooamii.github.io/blob/master/2018/5.png)

![image](https://github.com/WhooAmii/whooamii.github.io/blob/master/2018/6.png)
